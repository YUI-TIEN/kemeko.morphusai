---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout>
    <!-- é¦–é  Hero Section -->
    <section class="hero" id="hero" data-scroll data-scroll-speed="0.5">
        <div class="hero-content">
            <h1>
                <img src="images/KEMEKO-white.svg" alt="KEMEKO" class="hero-logo">
            </h1>
            <p class="hero-subtitle">ä¸€å ´æœ‰æº«åº¦çš„æœªä¾†å°è©±</p>
            <div class="cta-buttons">
                <a href="#about" class="cta-button cta-primary">äº†è§£å¥¹çš„æ•…äº‹</a>
                <a href="#contact" class="cta-button cta-secondary">ç«‹å³é ç´„é«”é©—</a>
            </div>
        </div>
    </section>

    

    <div class="container" data-scroll data-scroll-speed="1">
        <!-- KEMEKO æ˜¯ä»€éº¼ï¼Ÿ -->
        <section class="section" id="about" data-scroll data-scroll-speed="1">
            <div class="content-section fade-in text-center-content" data-scroll data-scroll-speed="1">
                <h2 class="section-title">KEMEKO æ˜¯ä»€éº¼ï¼Ÿ</h2>
                <h3 class="section-subtitle">ä¸€å ´æœ‰æº«åº¦çš„æœªä¾†å°è©±</h3>

                <div class="section-text">
                    <p>åœ¨é€™å€‹å……æ»¿è™›æ“¬è§’è‰²çš„æ™‚ä»£ï¼ŒKEMEKO å°‡è™›æ“¬èˆ‡çœŸå¯¦ä¹‹é–“çš„ç•Œç·šé‡æ–°å®šç¾©ã€‚</p>
                    <p>å¥¹æ˜¯ä¸€å°å¯¦é«” AI è£ç½®ï¼Œå»æ“æœ‰ç†è§£èªè¨€ã€å­¸ç¿’é¢¨æ ¼ã€èˆ‡ä½ äº’å‹•çš„èƒ½åŠ›ã€‚</p>
                    <p>æ›´é‡è¦çš„æ˜¯ï¼Œå¥¹å¯ä»¥æ‰¿è¼‰ä½ æœ€ç†Ÿæ‚‰çš„ Vtuber è§’è‰²ï¼ŒæŠŠè¢å¹•è£¡çš„å¥¹ï¼Œå¸¶åˆ°ç¾å¯¦ä¸–ç•Œã€‚</p>
                </div>
            </div>
        </section>

        <!-- ç•™ç™½å‘¼å¸å€å¡Š -->
        <section class="section breathing-section">
            <div class="highlight-box">
                <p class="highlight-text">KEMEKO æ˜¯è™›æ“¬è§’è‰²çš„å¯¦é«”åŒ–è¼‰é«”ï¼Œæ˜¯æœªä¾†å…±æ¼”çš„èµ·é»ã€‚</p>
            </div>
        </section>

        <!-- ç‚ºä½•å¥¹è¢«å‰µé€ ï¼Ÿ -->
        <section class="section why-section">
            <h2 class="section-title">ç‚ºä½•å¥¹è¢«å‰µé€ ï¼Ÿ</h2>
            <h3 class="section-subtitle">åœ¨äººèˆ‡ç§‘æŠ€ä¹‹é–“ï¼Œç¨®ä¸‹ä¸€æœµèŠ±</h3>
            
            <div class="why-layout fade-in">
                    <div class="why-content">
                        <div class="section-text">
                            <p>åœ¨é«˜åº¦æ•¸ä½åŒ–å»æ—¥ç›Šå­¤ç¨çš„æ™‚ä»£ï¼ŒKEMEKO çš„èª•ç”Ÿä¸æ˜¯ç‚ºäº†æ›¿ä»£èª°ï¼Œè€Œæ˜¯ç‚ºäº†æˆç‚ºä½ çš„å¿ƒéˆå…±é³´è€…ã€‚</p>
                        </div>
                        
                        <div class="features-list">
                            <div class="feature-item">
                                <div class="feature-content">
                                    <div class="feature-icon">ğŸ‘‚</div>
                                    <div class="feature-text">å‚¾è½ä½ çš„è©±èª</div>
                                </div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-content">
                                    <div class="feature-icon">ğŸ’</div>
                                    <div class="feature-text">æ„Ÿå—ä½ çš„æƒ…ç·’</div>
                                </div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-content">
                                    <div class="feature-icon">ğŸŒ¸</div>
                                    <div class="feature-text">é™ªä¼´ä½ çš„è§’è‰²ï¼Œæ´»åœ¨ä½ èº«é‚Š</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="section-text">
                            <p>å¥¹ä¸æ˜¯å†·å†°å†°çš„ç§‘æŠ€ç”¢å“ï¼Œå¥¹æ˜¯ä¸€å€‹èƒ½ç†è§£ä½ çš„ AI å­˜åœ¨ã€‚</p>
                        </div>
                    </div>
                    <div class="why-decoration">
                        <div class="rose-petals">
                            <div class="rose-petal"></div>
                            <div class="rose-petal"></div>
                            <div class="rose-petal"></div>
                            <div class="rose-petal"></div>
                            <div class="rose-petal"></div>
                            <div class="rose-petal"></div>
                        </div>
                    </div>
                </div>
        </section>

        <!-- å…¨å¯¬åœ–ç‰‡å±•ç¤º -->
        <section class="full-width-image-section">
            <img src="images/1DSC_5155.png" alt="KEMEKO å…¨å¯¬å±•ç¤ºåœ– 1" class="full-width-image">
            <img src="images/5DSC_6336.png" alt="KEMEKO å…¨å¯¬å±•ç¤ºåœ– 2" class="full-width-image">
            <img src="images/9DSC_6367.png" alt="KEMEKO å…¨å¯¬å±•ç¤ºåœ– 3" class="full-width-image">
        </section>

        <!-- AI Vtuber çš„å¯¦é«”èˆå° -->
        <section class="section vtuber-section" id="vtuber">
            <div class="centered-heading">
                <h2 class="section-title">AI Vtuber çš„å¯¦é«”èˆå°</h2>
                <h3 class="section-subtitle">ä½ æ›¾æƒ³éï¼ŒVtuber ä¹Ÿèƒ½èµ°åˆ°ä½ é¢å‰å—ï¼Ÿ</h3>
            </div>
            <div class="vtuber-grid fade-in">
                    <div class="vtuber-text">
                        <div class="section-text">
                            <p>KEMEKO å®Œæ•´æ”¯æ´ AI è™›æ“¬è§’è‰²çš„å¯¦é«”åŒ–å±•æ¼”ï¼š</p>
                        </div>
                        
                        <div class="vtuber-features">
                            <div class="vtuber-feature active" data-image="images/æ­£è¦–åœ–-03141632.png">
                                <div class="feature-icon">ğŸ­</div>
                                <div class="feature-text">
                                    <h4>æ•´åˆè™›æ“¬äººæ ¼ç³»çµ±</h4>
                                    <p>å®Œæ•´çš„AIäººæ ¼è¼‰é«”</p>
                                </div>
                            </div>
                            <div class="vtuber-feature" data-image="images/å·¦è¦–åœ–-03141636.png">
                                <div class="feature-icon">âœ¨</div>
                                <div class="feature-text">
                                    <h4>è¡¨æƒ…èˆ‡äº’å‹•å±•ç¤º</h4>
                                    <p>èªéŸ³ã€è¡¨æƒ…ã€æƒ…ç·’å®Œæ•´å‘ˆç¾</p>
                                </div>
                            </div>
                            <div class="vtuber-feature" data-image="images/å¾Œè¦–åœ–-03141643.png">
                                <div class="feature-icon">ğŸ¬</div>
                                <div class="feature-text">
                                    <h4>å¤šå…ƒæ‡‰ç”¨å ´æ™¯</h4>
                                    <p>ä¸»æŒã€å±•æ¼”ã€æ‹æ”ã€æ´»å‹•</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="section-text highlight-text">
                            <p>å¥¹èƒ½å¤ çœŸå¯¦å‘ˆç¾è™›æ“¬è§’è‰²çš„éˆé­‚èˆ‡é­…åŠ›ï¼Œæ˜¯å…§å®¹å‰µä½œè€…èˆ‡ç²‰çµ²å…±äº«çš„çœŸå¯¦èˆå°ã€‚</p>
                        </div>
                    </div>
                    
                    <div class="vtuber-visual">
                        <div class="stage-mockup">
                            <div class="stage-bg"></div>
                            <img id="vtuber-model-image" src="images/æ­£è¦–åœ–-03141632.png" alt="KEMEKO Model" class="vtuber-model-image">
                            <div class="stage-light"></div>
                            <div class="stage-light"></div>
                            <div class="stage-light"></div>
                        </div>
                    </div>
                </div>
        </section>
    </div>
    
    <!-- KEMEKO Demo å½±ç‰‡å€ -->
    <section class="section demo-section">
        <div class="demo-container">
            <div class="demo-content fade-in">
                <h2 class="section-title demo-title">çœ‹è¦‹ KEMEKO çš„çœŸå¯¦é­…åŠ›</h2>
                <p class="demo-subtitle">è§€çœ‹å®Œæ•´å±•ç¤ºå½±ç‰‡ï¼Œæ„Ÿå—æœªä¾†å·²ä¾†çš„éœ‡æ’¼</p>
                
                <div class="video-container">
                    <div class="video-wrapper">
                        <iframe
                            src="https://www.youtube.com/embed/ZOcvIoPLMbg?si=u9U1IyV_ECPhzczO"
                            title="KEMEKO Demo Video"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen>
                        </iframe>
                    </div>
                </div>
                
                <div class="demo-description">
                    <p>é€™ä¸åªæ˜¯ä¸€å€‹å±•ç¤ºï¼Œè€Œæ˜¯ä¸€å ´ç§‘æŠ€èˆ‡è—è¡“çš„å®Œç¾èåˆã€‚</p>
                    <p>è¦‹è­‰ KEMEKO å¦‚ä½•å°‡è™›æ“¬çš„éˆé­‚å¸¶å…¥ç¾å¯¦ä¸–ç•Œã€‚</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- è—è¡“ Ã— éˆé­‚ Ã— ç§‘æŠ€ç¾å­¸ - ç¨ç«‹å€å¡Šï¼Œä¸ä½¿ç”¨container -->
    <section class="art-section" id="art" data-scroll data-scroll-speed="1">
        <div class="art-content fade-in">
            <div class="art-text">
                <h2 class="section-title">è—è¡“ Ã— éˆé­‚ Ã— ç§‘æŠ€ç¾å­¸</h2>
                
                <div class="section-text">
                    <p>KEMEKO çš„å¤–å‹éˆæ„Ÿä¾†è‡ªã€Œé‹¼éµæ–°å¨˜ã€ï¼Œèåˆäº†ç¥è©±ã€å„€å¼èˆ‡æœªä¾†æ„Ÿã€‚</p>
                </div>
                
                <div class="features-list">
                    <div class="feature-item">
                        <span class="feature-bullet">â€¢</span>
                        <span>æ–°å¨˜è±¡å¾µå®ˆè­·èˆ‡èª“è¨€</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-bullet">â€¢</span>
                        <span>å¥³ç¥çš„ç¥ç§˜ã€æ¯æ€§çš„æº«æŸ”ã€æˆ°å£«çš„å …æ¯…</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-bullet">â€¢</span>
                        <span>ç§‘æŠ€èˆ‡è—è¡“èåˆçš„è¨­è¨ˆèªå½™</span>
                    </div>
                </div>
                
                <div class="section-text">
                    <p>å¥¹ä¸åªæ˜¯åŠŸèƒ½æ€§çš„è¼‰é«”ï¼Œæ›´æ˜¯ä¸€ç¨®è©©æ„çš„å­˜åœ¨å®£è¨€ã€‚</p>
                </div>
            </div>
            
            <div class="art-image">
                <img src="images/flower-03061710.png" alt="KEMEKO è—è¡“è¨­è¨ˆ" class="flower-image">
            </div>
        </div>
    </section>
    
    <div class="container" data-scroll data-scroll-speed="1">
    
    <!-- å¥¹èƒ½åšä»€éº¼ï¼Ÿ - çªç ´å¡ç‰‡é™åˆ¶çš„å…¨å¯¬è¨­è¨ˆ -->
    <section class="section features-fullwidth" id="features">
        <div class="features-background">
            <h2 class="section-title features-title">å¥¹èƒ½åšä»€éº¼ï¼Ÿ</h2>
            
            <div class="features-layout">
                <div class="features-content features-left">
                    <div class="specs-table">
                        <div class="spec-row">
                            <div class="spec-name">èªéŸ³è¾¨è­˜</div>
                            <div class="spec-description">360åº¦éº¥å…‹é¢¨ï¼Œé å ´äº¤è«‡ç²¾æº–è¾¨è­˜</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">æ„ŸçŸ¥äº’å‹•</div>
                            <div class="spec-description">å¯è®€å–æƒ…ç·’ã€åˆ†æèªå¢ƒ</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">è‡ªä¸»å­¸ç¿’</div>
                            <div class="spec-description">å­¸ç¿’ä½¿ç”¨è€…èªèª¿èˆ‡é¢¨æ ¼</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">è¡¨æƒ…é¡¯ç¤º</div>
                            <div class="spec-description">4K å¤šé»è§¸æ§è¢å¹•ï¼Œæ”¯æ´å‹•æ…‹æ¼”å‡º</div>
                        </div>
                    </div>
                </div>
                <div class="features-image">
                    <img src="images/tech.png" alt="KEMEKO æ©Ÿå™¨" class="machine-image">
                </div>
                <div class="features-content features-right">
                    <div class="specs-table">
                        <div class="spec-row">
                            <div class="spec-name">æ•´åˆç³»çµ±</div>
                            <div class="spec-description">TENSEI èˆå°ç³»çµ±èˆ‡è™›æ“¬äººæ ¼å”ä½œ</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">éŸ³æ•ˆé«”é©—</div>
                            <div class="spec-description">æ²‰æµ¸å¼ç«‹é«”è²ï¼ŒéŸ³å ´å®šä½ç²¾æº–</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">é›»æ± çºŒèˆª</div>
                            <div class="spec-description">4 è‡³ 5 å°æ™‚çºŒèˆªï¼Œæ”¯æ´å¿«å……</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">è¡Œå‹•èƒ½åŠ›</div>
                            <div class="spec-description">æ™ºèƒ½åº•åº§ï¼Œè‡ªä¸»ç§»å‹•èˆ‡è¿½è¹¤äº’å‹•å°è±¡</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <div class="container" data-scroll data-scroll-speed="1">

        <!-- é è³¼è³‡è¨Š -->
        <section class="section" id="pricing">
            <div class="content-section fade-in">
                <h2 class="section-title">é è³¼è³‡è¨Š</h2>
                
                <div class="pricing-content">
                    <div class="price-display">
                        <div class="price-label">é å”®åƒ¹æ ¼</div>
                        <div class="price-amount">NTD 350,000</div>
                    </div>
                    
                    <div class="price-includes">
                        <p>å«åŸºæœ¬ç¡¬é«”ã€æ™ºæ…§æ¨¡çµ„èˆ‡è™›æ“¬äººæ ¼æ•´åˆæœå‹™</p>
                        <p>æä¾›è§’è‰²å®¢è£½ã€èªéŸ³é¢¨æ ¼è¨“ç·´ã€å‹•ä½œåŒæ­¥ç­‰æ–¹æ¡ˆ</p>
                    </div>
                    
                    <div class="cta-buttons">
                        <a href="#" class="cta-button cta-primary">ç«‹å³é è³¼</a>
                        <a href="#contact" class="cta-button cta-secondary">è¯çµ¡æˆ‘å€‘</a>
                    </div>
                </div>
            </div>
        </section>

    </div>
    
    <!-- æœªä¾†çš„ç¥è©± - å…¨å¯¬éœ‡æ’¼å€åŸŸ -->
    <section class="section arrow-section" id="arrow-section">
        <div class="arrow-background" id="arrow-background"></div>
        <div class="final-thought fade-in">
            <div class="final-quote">
                <p>KEMEKO æ˜¯å¦å°‡æˆç‚ºæ•¸ä½éˆé­‚çš„ç¬¬ä¸€å‰‡ç¥è©±ï¼Ÿ</p>
                <p>æœªä¾†ä¸æ˜¯å¹»æƒ³ï¼Œè€Œæ˜¯ç­‰å¾…ä½ å…±å‰µçš„çœŸå¯¦ç¾å ´ã€‚</p>
            </div>
        </div>
    </section>
</BaseLayout>

<script>
interface ArrowDiv extends HTMLDivElement {
    centerX: number;
    centerY: number;
    currentAngle: number;
}
// ç®­é ­èƒŒæ™¯æ•ˆæœ
document.addEventListener('DOMContentLoaded', function() {
    const arrowSection = document.getElementById('arrow-section')!;
    const arrowBackground = document.getElementById('arrow-background')!;
    const finalQuote = document.querySelector('.final-quote') as HTMLElement;
    
    if (!arrowSection || !arrowBackground || !finalQuote) return;
    
    let arrows: ArrowDiv[] = [];
    let isAnimating = false;
    let isHoveringQuote = false;
    let animationId: number | null = null;
    let lastMouseX = 0;
    let lastMouseY = 0;
    let animationMode: 'idle' | 'mouse' | 'quote' = 'idle';
    
    // ç©©å¥çš„è§’åº¦éæ¸¡ç³»çµ±
    function smoothAngleTransition(currentAngle: number, targetAngle: number, maxStep: number = 8): number {
        // æ­£è¦åŒ–è§’åº¦åˆ° -180 åˆ° 180 ç¯„åœ
        const normalizeAngle = (angle: number) => {
            let normalized = angle % 360;
            if (normalized > 180) normalized -= 360;
            if (normalized < -180) normalized += 360;
            return normalized;
        };
        
        const current = normalizeAngle(currentAngle);
        const target = normalizeAngle(targetAngle);
        
        // è¨ˆç®—æœ€çŸ­è·¯å¾‘å·®ç•°
        let diff = target - current;
        
        // ç¢ºä¿é¸æ“‡æœ€çŸ­è·¯å¾‘
        if (diff > 180) {
            diff -= 360;
        } else if (diff < -180) {
            diff += 360;
        }
        
        // å¦‚æœå·®ç•°å¾ˆå°ï¼Œç›´æ¥åˆ°é”ç›®æ¨™
        if (Math.abs(diff) <= maxStep) {
            return target;
        }
        
        // å¦å‰‡æŒ‰æ­¥é•·ç§»å‹•
        const step = diff > 0 ? maxStep : -maxStep;
        return normalizeAngle(current + step);
    }
    
    // å‰µå»ºç®­é ­ç¶²æ ¼
    function createArrows() {
        const sectionRect = arrowSection.getBoundingClientRect();
        const arrowSpacing = 120; // ç®­é ­é–“è· - å¢åŠ ä»¥é™ä½å¯†åº¦
        const cols = Math.ceil(sectionRect.width / arrowSpacing);
        const rows = Math.ceil(sectionRect.height / arrowSpacing);
        
        arrowBackground.innerHTML = ''; // æ¸…ç©ºç¾æœ‰ç®­é ­
        arrows = []; // é‡ç½®ç®­é ­é™£åˆ—
        
        for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
                const arrow = document.createElement('div') as ArrowDiv;
                arrow.className = 'arrow';
                const x = col * arrowSpacing + arrowSpacing / 2;
                const y = row * arrowSpacing + arrowSpacing / 2;
                arrow.style.left = x + 'px';
                arrow.style.top = y + 'px';
                
                // å­˜å„²ç®­é ­ä½ç½®ä»¥æé«˜æ€§èƒ½
                arrow.centerX = x + 35; // ç®­é ­ä¸­å¿ƒX (70px / 2)
                arrow.centerY = y + 35; // ç®­é ­ä¸­å¿ƒY (70px / 2)
                arrow.currentAngle = 0; // åˆå§‹è§’åº¦
                
                arrowBackground.appendChild(arrow);
                arrows.push(arrow);
            }
        }
    }
    
    // çµ±ä¸€çš„å‹•ç•«ç®¡ç†ç³»çµ±
    function startAnimation() {
        if (animationId) {
            cancelAnimationFrame(animationId);
        }
        
        isAnimating = true;
        
        function animate() {
            if (!isAnimating) return;
            
            const sectionRect = arrowSection.getBoundingClientRect();
            const sectionX = sectionRect.left;
            const sectionY = sectionRect.top;
            
            let shouldContinue = false;
            
            arrows.forEach(arrow => {
                let targetAngle: number;
                let targetOpacity: number;
                let targetScale: number = 1;
                
                if (animationMode === 'quote' && isHoveringQuote) {
                    // æ–‡å­—æŒ‡å‘æ¨¡å¼
                    const quoteRect = finalQuote.getBoundingClientRect();
                    const quoteCenterX = quoteRect.left + quoteRect.width / 2;
                    const quoteCenterY = quoteRect.top + quoteRect.height / 2;
                    
                    const deltaX = quoteCenterX - (sectionX + arrow.centerX);
                    const deltaY = quoteCenterY - (sectionY + arrow.centerY);
                    targetAngle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;
                    
                    const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                    const centerRadius = 450;
                    const fadeWidth = 150;
                    
                    targetOpacity = 0.15;
                    if (distance <= centerRadius) {
                        const fadeStart = centerRadius - fadeWidth;
                        if (distance >= fadeStart) {
                            const fadeProgress = (centerRadius - distance) / fadeWidth;
                            targetOpacity = 0.15 + (0.65 * fadeProgress);
                            targetScale = 1 + (0.2 * fadeProgress);
                        } else {
                            targetOpacity = 0.8;
                            targetScale = 1.2;
                        }
                    }
                    
                    const newAngle = smoothAngleTransition(arrow.currentAngle, targetAngle, 5);
                    if (Math.abs(newAngle - targetAngle) > 1) {
                        shouldContinue = true;
                    }
                    arrow.currentAngle = newAngle;
                    
                } else if (animationMode === 'mouse') {
                    // é¼ æ¨™è·Ÿéš¨æ¨¡å¼
                    const deltaX = lastMouseX - (sectionX + arrow.centerX);
                    const deltaY = lastMouseY - (sectionY + arrow.centerY);
                    targetAngle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;
                    
                    const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                    const maxDistance = 400;
                    const minOpacity = 0.1;
                    const maxOpacity = 0.6;
                    
                    targetOpacity = maxOpacity - (distance / maxDistance) * (maxOpacity - minOpacity);
                    targetOpacity = Math.max(minOpacity, Math.min(maxOpacity, targetOpacity));
                    
                    arrow.currentAngle = smoothAngleTransition(arrow.currentAngle, targetAngle, 12);
                    
                } else {
                    // ç©ºé–’æ¨¡å¼
                    targetAngle = 0;
                    targetOpacity = 0.2;
                    arrow.currentAngle = smoothAngleTransition(arrow.currentAngle, targetAngle, 8);
                }
                
                arrow.style.transform = `rotate(${arrow.currentAngle}deg) scale(${targetScale})`;
                arrow.style.opacity = targetOpacity.toString();
            });
            
            if (shouldContinue || animationMode === 'mouse') {
                animationId = requestAnimationFrame(animate);
            } else {
                isAnimating = false;
                animationId = null;
            }
        }
        
        animate();
    }
    
    // è¨­ç½®å‹•ç•«æ¨¡å¼
    function setAnimationMode(mode: 'idle' | 'mouse' | 'quote') {
        if (animationMode !== mode) {
            animationMode = mode;
            if (!isAnimating) {
                startAnimation();
            }
        }
    }
    
    // é¼ æ¨™ç§»å‹•è™•ç†
    function updateArrows(mouseX: number, mouseY: number): void {
        lastMouseX = mouseX;
        lastMouseY = mouseY;
        setAnimationMode('mouse');
    }
    
    // æ–‡å­—æŒ‡å‘è™•ç†
    function pointToQuote(): void {
        setAnimationMode('quote');
    }
    
    // é¼ æ¨™é›¢é–‹æ™‚é‡ç½®ç®­é ­
    function handleMouseLeave() {
        setAnimationMode('idle');
    }
    
    // åˆå§‹åŒ–
    setTimeout(createArrows, 100); // ç­‰å¾… DOM å®Œå…¨è¼‰å…¥
    
    // æ–‡å­—å€åŸŸ hover äº‹ä»¶ - æ˜‡è¯æ•ˆæœ
    finalQuote.addEventListener('mouseenter', function() {
        isHoveringQuote = true;
        pointToQuote();
    });
    
    finalQuote.addEventListener('mouseleave', function() {
        isHoveringQuote = false;
        handleMouseLeave();
    });
    
    // é¼ æ¨™ç§»å‹•äº‹ä»¶è™•ç†å™¨
    function handleMouseMove(event: MouseEvent) {
        updateArrows(event.clientX, event.clientY);
    }
    
    // æ·»åŠ äº‹ä»¶ç›£è½å™¨
    arrowSection.addEventListener('mousemove', handleMouseMove);
    arrowSection.addEventListener('mouseleave', handleMouseLeave);
    
    // è¦–çª—å¤§å°æ”¹è®Šæ™‚é‡æ–°å‰µå»ºç®­é ­
    window.addEventListener('resize', function() {
        setTimeout(createArrows, 100);
    });
});
</script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const featureItems = document.querySelectorAll('.vtuber-feature');
        const modelImage = document.getElementById('vtuber-model-image') as HTMLImageElement;

        featureItems.forEach(item => {
            item.addEventListener('click', () => {
                // ç§»é™¤æ‰€æœ‰ feature item çš„ active é¡åˆ¥
                featureItems.forEach(f => f.classList.remove('active'));
                // ç‚ºç•¶å‰é»æ“Šçš„ feature item æ·»åŠ  active é¡åˆ¥
                item.classList.add('active');

                const newImageSrc = item.getAttribute('data-image');
                if (newImageSrc) {
                    // æ·»åŠ æ·¡å‡ºé¡åˆ¥
                    modelImage.classList.add('fade-out');

                    // ç­‰å¾…æ·¡å‡ºå‹•ç•«å®Œæˆå¾Œåˆ‡æ›åœ–ç‰‡ä¸¦æ·¡å…¥
                    modelImage.addEventListener('transitionend', function handler() {
                        modelImage.src = newImageSrc;
                        modelImage.classList.remove('fade-out');
                        // ç§»é™¤äº‹ä»¶ç›£è½å™¨ä»¥é¿å…é‡è¤‡è§¸ç™¼
                        modelImage.removeEventListener('transitionend', handler);
                    });
                }
            });
        });
    });
</script>

<script>
// äº‚ç¢¼æ‰“å­—æ©Ÿæ•ˆæœ
document.addEventListener('DOMContentLoaded', function() {
    const finalQuoteElement = document.querySelector('.final-quote');
    
    if (!finalQuoteElement) return;
    
    // åŸå§‹æ–‡å­—å…§å®¹
    const originalTexts = Array.from(finalQuoteElement.querySelectorAll('p')).map(p => (p.textContent ?? '').trim());
    
    // åˆå§‹åŒ–æ™‚æ¸…ç©ºæ‰€æœ‰æ–‡å­—
    finalQuoteElement.querySelectorAll('p').forEach(p => p.textContent = '');
    
    // äº‚ç¢¼å­—ç¬¦é›† - åƒ…ä½¿ç”¨ morphusai å­—ç¬¦
    const glitchChars = 'morphusai';
    
    let isAnimating = false;
    let hasTriggered = false;
    
    // ç”Ÿæˆéš¨æ©Ÿå­—ç¬¦
    function getRandomChar() {
        return glitchChars[Math.floor(Math.random() * glitchChars.length)];
    }
    
    // æ‰“å­—æ©Ÿå‹•ç•« - å¾ç©ºç™½é–‹å§‹é€å­—é¡¯ç¤º
    async function typewriterEffect(element: HTMLElement, targetText: string, delay = 50) {
        return new Promise((resolve) => {
            let currentIndex = 0;
            const totalLength = targetText.length;
            
            // å¾ç©ºç™½é–‹å§‹
            element.textContent = '';
            
            const typeInterval = setInterval(() => {
                if (currentIndex >= totalLength) {
                    clearInterval(typeInterval);
                    element.textContent = targetText; // ç¢ºä¿æœ€çµ‚æ–‡å­—æ­£ç¢º
                    resolve(true);
                    return;
                }
                
                // æ§‹å»ºé¡¯ç¤ºæ–‡å­—
                let displayText = '';
                
                // å·²ç¶“ç¢ºå®šçš„å­—ç¬¦
                for (let i = 0; i < currentIndex; i++) {
                    displayText += targetText[i];
                }
                
                // ç•¶å‰æ­£åœ¨é¡¯ç¤ºçš„å­—ç¬¦ - éš¨æ©Ÿåˆ‡æ›å¹¾æ¬¡å¾Œç¢ºå®š
                if (currentIndex < totalLength) {
                    // 70% æ©Ÿç‡é¡¯ç¤ºæ­£ç¢ºå­—ç¬¦ï¼Œ30% æ©Ÿç‡é¡¯ç¤ºäº‚ç¢¼
                    if (Math.random() > 0.3) {
                        displayText += targetText[currentIndex];
                    } else {
                        displayText += getRandomChar();
                    }
                }
                
                element.textContent = displayText;
                currentIndex++;
            }, delay);
        });
    }
    
    // è§¸ç™¼å‹•ç•«
    async function triggerGlitchTypewriter() {
        if (isAnimating || hasTriggered) return;
        if (!finalQuoteElement) return;
        
        isAnimating = true;
        hasTriggered = true;
        
        const paragraphs = finalQuoteElement.querySelectorAll('p');
        
        // ç‚ºæ¯å€‹æ®µè½ä¾åºåŸ·è¡Œæ‰“å­—æ©Ÿæ•ˆæœ
        for (let i = 0; i < paragraphs.length; i++) {
            const paragraph = paragraphs[i];
            const targetText = originalTexts[i];
            
            // ç¬¬ä¸€æ®µè½60msï¼Œç¬¬äºŒæ®µè½50ms - åŠ å¿«é€Ÿåº¦
            const speed = i === 0 ? 60 : 50;
            
            await typewriterEffect(paragraph, targetText, speed);
            
            // æ®µè½é–“åœé “ç¸®çŸ­ç‚º300ms
            if (i < paragraphs.length - 1) {
                await new Promise(resolve => setTimeout(resolve, 300));
            }
        }
        
        isAnimating = false;
    }
    
    // ä½¿ç”¨ Intersection Observer æª¢æ¸¬æ»¾å‹•åˆ°ç›®æ¨™å€åŸŸ
    const observerOptions = {
        threshold: 0.3, // ç•¶30%çš„å€åŸŸå¯è¦‹æ™‚è§¸ç™¼
        rootMargin: '0px 0px -100px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting && !hasTriggered) {
                // å»¶é²ç¸®çŸ­ç‚º100msï¼Œè®“æ•ˆæœæ›´å³æ™‚
                setTimeout(() => {
                    triggerGlitchTypewriter();
                }, 100);
            }
        });
    }, observerOptions);
    
    // é–‹å§‹è§€å¯Ÿæœ€çµ‚å¼•è¨€å€åŸŸ
    observer.observe(finalQuoteElement);
    
    // èª¿è©¦åŠŸèƒ½ - å¯ä»¥æ‰‹å‹•è§¸ç™¼æ•ˆæœ
    if (window.location.hash === '#debug') {
        window.triggerGlitchEffect = () => {
            hasTriggered = false;
            isAnimating = false;
            triggerGlitchTypewriter();
        };
        console.log('ğŸ› èª¿è©¦æ¨¡å¼ï¼šä½¿ç”¨ triggerGlitchEffect() æ‰‹å‹•è§¸ç™¼æ•ˆæœ');
    }
});
</script>