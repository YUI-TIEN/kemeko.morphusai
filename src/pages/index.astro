---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout>
    <!-- é¦–é  Hero Section -->
    <section class="hero" id="hero">
        <div class="hero-content" data-scroll data-scroll-speed="1">
            <h1>
                <img src="images/KEMEKO-white.svg" alt="KEMEKO" class="hero-logo">
            </h1>
            <p class="hero-subtitle">ä¸€å ´æœ‰æº«åº¦çš„æœªä¾†å°è©±</p>
            <div class="cta-buttons">
                <a href="#about" class="cta-button cta-primary">äº†è§£å¥¹çš„æ•…äº‹</a>
                <a href="#contact" class="cta-button cta-secondary">ç«‹å³é ç´„é«”é©—</a>
            </div>
        </div>
    </section>

    

    <div class="container">
        <!-- KEMEKO æ˜¯ä»€éº¼ï¼Ÿ -->
        <section class="section about-section" id="about">
            <div class="content-section fade-in text-center-content" data-scroll data-scroll-speed="1">
                <h2 class="section-title">é—œæ–¼ KEMEKO</h2>
                <h3 class="section-subtitle">ä¸€å ´æœ‰æº«åº¦çš„æœªä¾†å°è©±</h3>

                <div class="section-text">
                    <p>åœ¨é€™å€‹å……æ»¿è™›æ“¬è§’è‰²çš„æ™‚ä»£ï¼ŒKEMEKO å°‡è™›æ“¬èˆ‡çœŸå¯¦ä¹‹é–“çš„ç•Œç·šé‡æ–°å®šç¾©ã€‚</p>
                    <p>å¥¹æ˜¯ä¸€å°å¯¦é«” AI è£ç½®ï¼Œå»æ“æœ‰ç†è§£èªè¨€ã€å­¸ç¿’é¢¨æ ¼ã€èˆ‡ä½ äº’å‹•çš„èƒ½åŠ›ã€‚</p>
                    <p>æ›´é‡è¦çš„æ˜¯ï¼Œå¥¹å¯ä»¥æ‰¿è¼‰ä½ æœ€ç†Ÿæ‚‰çš„ Vtuber è§’è‰²ï¼ŒæŠŠè¢å¹•è£¡çš„å¥¹ï¼Œå¸¶åˆ°ç¾å¯¦ä¸–ç•Œã€‚</p>
                </div>
            </div>
            
            <!-- ç•™ç™½å‘¼å¸å€å¡Š - ä½µå…¥ about section -->
            <div class="breathing-section">
                <div class="highlight-box" data-scroll data-scroll-speed="1">
                    <p class="highlight-text">KEMEKO æ˜¯è™›æ“¬éˆé­‚çš„å¯¦é«”å®¹å™¨ï¼Œæ˜¯æœªä¾†å…±æ¼”çš„åºç« ã€‚</p>
                </div>
            </div>
        </section>

        <!-- ç‚ºä½•å¥¹è¢«å‰µé€ ï¼Ÿ -->
        <section class="section why-section" id="why">
            <div class="why-container" data-scroll data-scroll-speed="1">
                <div class="why-header">
                    <h2 class="section-title">å‰µé€ ä¹‹ç”±</h2>
                    <h3 class="section-subtitle">è®“ç§‘æŠ€èˆ‡äººæ€§ä¹‹é–“é–‹å‡ºä¸€æœµèŠ±</h3>
                </div>
                
                <div class="why-content">
                    <div class="why-intro">
                        <p>åœ¨é«˜åº¦æ•¸ä½åŒ–å»æ—¥ç›Šå­¤ç¨çš„æ™‚ä»£ï¼ŒKEMEKO çš„èª•ç”Ÿä¸æ˜¯ç‚ºäº†æ›¿ä»£èª°ï¼Œè€Œæ˜¯ç‚ºäº†æˆç‚ºä½ çš„å¿ƒéˆå…±é³´è€…ã€‚</p>
                    </div>
                    
                    <div class="why-features">
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ‘‚</div>
                            <h4 class="feature-title">å‚¾è½ä½ çš„è©±èª</h4>
                            <p class="feature-description">çœŸæ­£çš„å‚¾è½è€…ï¼Œç†è§£ä½ çš„æ¯ä¸€å€‹å­—</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ’</div>
                            <h4 class="feature-title">æ„Ÿå—ä½ çš„æƒ…ç·’</h4>
                            <p class="feature-description">æ•éŠ³æ„ŸçŸ¥ï¼Œèˆ‡ä½ æƒ…æ„ŸåŒé »</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸŒ¸</div>
                            <h4 class="feature-title">é™ªä¼´ä½ çš„è§’è‰²ï¼Œæ´»åœ¨ä½ èº«é‚Š</h4>
                            <p class="feature-description">è™›æ“¬èˆ‡ç¾å¯¦çš„å®Œç¾çµåˆ</p>
                        </div>
                    </div>
                    
                    <div class="why-conclusion">
                        <p>å¥¹ä¸æ˜¯å†°å†·çš„è£ç½®ï¼Œè€Œæ˜¯ä¸€ä»½æº«æŸ”ç†è§£ã€‚</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- å±¤ç–Šåœ–ç‰‡å±•ç¤º - ç¨ç«‹æ–¼ container å¤– -->
        <div class="image_cards_wrap">
            <div class="image_cards_wrap__card">
                <div class="image_cards_wrap__card-stick image1">
                </div> 
            </div>
            <div class="image_cards_wrap__card">
                <div class="image_cards_wrap__card-stick image2">
                </div> 
            </div>
            <div class="image_cards_wrap__card">
                <div class="image_cards_wrap__card-stick image3">
                </div> 
            </div>
    </div>

    <div class="container">
        <!-- AI Vtuber çš„å¯¦é«”èˆå°èˆ‡å±•ç¤º -->
        <section class="section vtuber-demo-section" id="vtuber">
            <div class="vtuber-demo-container" data-scroll data-scroll-speed="1">
                <div class="vtuber-demo-content fade-in">
                    <div class="centered-heading">
                        <h2 class="section-title text-purple">Vtuber çš„çœŸå¯¦èˆå°</h2>
                        <h3 class="section-subtitle">æƒ³åƒä¸­çš„å¥¹ï¼Œå¦‚ä»Šè¿‘åœ¨å’«å°ºã€‚</h3>
                    </div>
                    
                    <div class="vtuber-intro">
                        <div class="section-text">
                            <p>ä½ æ›¾æƒ³éï¼ŒVtuber ä¹Ÿèƒ½èµ°åˆ°ä½ é¢å‰å—ï¼Ÿ</p>
                        </div>
                    </div>
                    
                    <div class="vtuber-video-showcase">
                        <div class="video-container">
                            <iframe
                                src="https://www.youtube.com/embed/ZOcvIoPLMbg?si=u9U1IyV_ECPhzczO"
                                title="KEMEKO Demo Video"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                    
                    <div class="vtuber-features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ­</div>
                            <div class="feature-content">
                                <h4>æ•´åˆè™›æ“¬äººæ ¼ç³»çµ±</h4>
                                <p>å®Œæ•´çš„AIäººæ ¼è¼‰é«”ï¼ŒçœŸå¯¦å‘ˆç¾è™›æ“¬è§’è‰²çš„éˆé­‚</p>
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">âœ¨</div>
                            <div class="feature-content">
                                <h4>è¡¨æƒ…èˆ‡äº’å‹•å±•ç¤º</h4>
                                <p>èªéŸ³ã€è¡¨æƒ…ã€æƒ…ç·’å®Œæ•´å‘ˆç¾ï¼Œç”Ÿå‹•çš„äº’å‹•é«”é©—</p>
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ¬</div>
                            <div class="feature-content">
                                <h4>å¤šå…ƒæ‡‰ç”¨å ´æ™¯</h4>
                                <p>ä¸»æŒã€å±•æ¼”ã€æ‹æ”ã€æ´»å‹•ï¼Œç„¡é™å¯èƒ½çš„å‰µä½œå¹³å°</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="vtuber-closing">
                        <div class="section-text highlight-text text-purple">
                            <p>é€™ä¸åªæ˜¯ä¸€å€‹å±•ç¤ºï¼Œè€Œæ˜¯ä¸€å ´ç§‘æŠ€èˆ‡è—è¡“çš„äº¤éŸ¿ç››å®´ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
    
    <!-- è—è¡“ Ã— éˆé­‚ Ã— ç§‘æŠ€ç¾å­¸ - ç¨ç«‹å€å¡Šï¼Œä¸ä½¿ç”¨container -->
    <section class="art-section" id="art">
        <div class="art-content fade-in">
            <div class="art-text" data-scroll data-scroll-speed="1">
                <h2 class="section-title">éˆé­‚ç§‘æŠ€ Ã— è—è¡“ç¾å­¸</h2>
                
                <div class="section-text">
                    <p>KEMEKO çš„å¤–å‹éˆæ„Ÿä¾†è‡ªã€Œé‹¼éµæ–°å¨˜ã€ï¼Œèåˆäº†ç¥è©±ã€å„€å¼èˆ‡æœªä¾†æ„Ÿã€‚</p>
                </div>
                
                <div class="features-list">
                    <div class="feature-item">
                        <span>æ–°å¨˜è±¡å¾µå®ˆè­·èˆ‡èª“è¨€</span>
                    </div>
                    <div class="feature-item">
                        <span>å¥³ç¥çš„ç¥ç§˜ã€æ¯æ€§çš„æº«æŸ”ã€æˆ°å£«çš„å …æ¯…</span>
                    </div>
                    <div class="feature-item">
                        <span>ç§‘æŠ€èˆ‡è—è¡“èåˆçš„è¨­è¨ˆèªå½™</span>
                    </div>
                </div>
                
                <div class="section-text">
                    <p>å¥¹ï¼Œæ˜¯ä¸€å ´è©©æ„çš„å­˜åœ¨å®£è¨€</p>
                </div>
            </div>
            
            
        </div>
    </section>
    
    <div class="container">
    
    <!-- å¥¹èƒ½åšä»€éº¼ï¼Ÿ - çªç ´å¡ç‰‡é™åˆ¶çš„å…¨å¯¬è¨­è¨ˆ -->
    <section class="section features-fullwidth" id="features">
        <div class="features-background">
            <h2 class="features-title section-title">å¥¹çš„å¯èƒ½</h2>
            
            <div class="features-layout">
                <div class="features-content" data-scroll data-scroll-speed="1">
                    <div class="specs-table">
                        <div class="spec-row">
                            <div class="spec-name">èªéŸ³è¾¨è­˜</div>
                            <div class="spec-description">360åº¦éº¥å…‹é¢¨ï¼Œé å ´äº¤è«‡ç²¾æº–è¾¨è­˜</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">æ„ŸçŸ¥äº’å‹•</div>
                            <div class="spec-description">å¯è®€å–æƒ…ç·’ã€åˆ†æèªå¢ƒ</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">è‡ªä¸»å­¸ç¿’</div>
                            <div class="spec-description">å­¸ç¿’ä½¿ç”¨è€…èªèª¿èˆ‡é¢¨æ ¼</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">è¡¨æƒ…é¡¯ç¤º</div>
                            <div class="spec-description">4K å¤šé»è§¸æ§è¢å¹•ï¼Œæ”¯æ´å‹•æ…‹æ¼”å‡º</div>
                        </div>
                    </div>
                </div>
                <div class="features-image" data-scroll data-scroll-speed="1">
                    <img src="images/tech.png" alt="KEMEKO æ©Ÿå™¨" class="machine-image">
                </div>
                <div class="features-content" data-scroll data-scroll-speed="1">
                    <div class="specs-table">
                        <div class="spec-row">
                            <div class="spec-name">æ•´åˆç³»çµ±</div>
                            <div class="spec-description">TENSEI èˆå°ç³»çµ±èˆ‡è™›æ“¬äººæ ¼å”ä½œ</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">éŸ³æ•ˆé«”é©—</div>
                            <div class="spec-description">æ²‰æµ¸å¼ç«‹é«”è²ï¼ŒéŸ³å ´å®šä½ç²¾æº–</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">é›»æ± çºŒèˆª</div>
                            <div class="spec-description">4 è‡³ 5 å°æ™‚çºŒèˆªï¼Œæ”¯æ´å¿«å……</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-name">è¡Œå‹•èƒ½åŠ›</div>
                            <div class="spec-description">æ™ºèƒ½åº•åº§ï¼Œè‡ªä¸»ç§»å‹•èˆ‡è¿½è¹¤äº’å‹•å°è±¡</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <div class="container">

        <!-- é è³¼è³‡è¨Š -->
        <section class="section pricing-section" id="pricing">
            <div class="pricing-container" data-scroll data-scroll-speed="1">
                <div class="pricing-header">
                    <h2 class="section-title">é è³¼è³‡è¨Š</h2>
                    <h3 class="section-subtitle">ä½ çš„æœªä¾†æ—…ç¨‹ï¼Œå¾æ­¤åˆ»å‡ºç™¼</h3>
                </div>
                
                <div class="pricing-layout" data-scroll data-scroll-speed="1">
                    <div class="pricing-image">
                        <div class="product-showcase">
                            <img src="images/4DSC_6333.png" alt="KEMEKO ç”¢å“å±•ç¤º" class="product-image">
                        </div>
                    </div>
                    
                    <div class="pricing-info">
                        <div class="pricing-card">
                            <div class="pricing-header-card">
                                <div class="price-label">é å”®åƒ¹æ ¼</div>
                                <div class="price-amount">
                                    <span class="currency">NTD</span>
                                    <span class="amount">350,000</span>
                                </div>
                            </div>
                            
                            <div class="pricing-features">
                                <div class="feature-item">
                                    <div class="feature-icon">ğŸ¯</div>
                                    <div class="feature-text">åŸºæœ¬ç¡¬é«”èˆ‡æ™ºæ…§æ¨¡çµ„</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">ğŸ¤–</div>
                                    <div class="feature-text">è™›æ“¬äººæ ¼æ•´åˆæœå‹™</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">âœ¨</div>
                                    <div class="feature-text">è§’è‰²å®¢è£½åŒ–èˆ‡èªéŸ³è¨“ç·´</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">ğŸ­</div>
                                    <div class="feature-text">å‹•ä½œåŒæ­¥æŠ€è¡“æ”¯æ´</div>
                                </div>
                            </div>
                            
                            <div class="pricing-actions">
                                <a href="#" class="cta-button cta-primary">ç«‹å³é è³¼</a>
                                <a href="#contact" class="cta-button cta-secondary">äº†è§£æ›´å¤š</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </div>
    
    <!-- æœªä¾†çš„ç¥è©± - å…¨å¯¬éœ‡æ’¼å€åŸŸ -->
    <section class="section arrow-section" id="arrow-section">
        <div class="arrow-background" id="arrow-background"></div>
        <div class="final-thought fade-in" data-scroll data-scroll-speed="1">
            <div class="final-quote">
                <p>å¥¹ï¼Œæ˜¯å¦æ˜¯æ•¸ä½éˆé­‚çš„ç¬¬ä¸€å‰‡å‚³å¥‡ï¼Ÿ</p>
                <p>æœªä¾†ï¼Œä¸æ˜¯é™é å¤¢æƒ³ï¼Œè€Œæ˜¯ä½ æˆ‘å…±è­œçš„ç¾åœ¨ã€‚</p>
            </div>
        </div>
    </section>
</BaseLayout>

<script>
// ç®­é ­å‹•ç•« - å…§è¯ç‰ˆæœ¬
document.addEventListener('DOMContentLoaded', function() {
        const arrowSection = document.getElementById('arrow-section');
        const arrowBackground = document.getElementById('arrow-background');
        const finalQuote = document.querySelector('.final-quote');
        
        if (!arrowSection || !arrowBackground || !finalQuote) return;
        
        let arrows = [];
        let isAnimating = false;
        let isHoveringQuote = false;
        let animationId = null;
        let lastMouseX = 0;
        let lastMouseY = 0;
        let animationMode = 'idle';
        
        // æ­£ç¢ºè™•ç†è§’åº¦ç’°å½¢æ€§è³ªçš„éæ¸¡ç³»çµ±
        function smoothAngleTransition(currentAngle, targetAngle, maxStep = 12) {
            let adjustedTargetAngle = targetAngle;
            while (adjustedTargetAngle - currentAngle > 180) {
                adjustedTargetAngle -= 360;
            }
            while (adjustedTargetAngle - currentAngle < -180) {
                adjustedTargetAngle += 360;
            }

            let angleDiff = adjustedTargetAngle - currentAngle;

            if (Math.abs(angleDiff) <= maxStep) {
                return adjustedTargetAngle;
            }

            const step = angleDiff > 0 ? maxStep : -maxStep;
            return currentAngle + step;
        }
        
        // å‰µå»ºç®­é ­ç¶²æ ¼
        function createArrows() {
            const sectionRect = arrowSection.getBoundingClientRect();
            const arrowSpacing = 200; // ç®­é ­é–“è·
            const cols = Math.ceil(sectionRect.width / arrowSpacing);
            const rows = Math.ceil(sectionRect.height / arrowSpacing);
            
            arrowBackground.innerHTML = '';
            arrows = [];
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    const arrow = document.createElement('div');
                    arrow.className = 'arrow';
                    const x = col * arrowSpacing + arrowSpacing / 2;
                    const y = row * arrowSpacing + arrowSpacing / 2;
                    arrow.style.left = x + 'px';
                    arrow.style.top = y + 'px';
                    
                    // å­˜å„²ç®­é ­ä½ç½®ä»¥æé«˜æ€§èƒ½ (120px / 2 = 60px)
                    arrow.centerX = x + 60;
                    arrow.centerY = y + 60;
                    arrow.currentAngle = 0;
                    
                    arrowBackground.appendChild(arrow);
                    arrows.push(arrow);
                }
            }
        }
        
        // çµ±ä¸€çš„å‹•ç•«ç®¡ç†ç³»çµ±
        function startAnimation() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            
            isAnimating = true;
            
            function animate() {
                if (!isAnimating) return;
                
                const sectionRect = arrowSection.getBoundingClientRect();
                const sectionX = sectionRect.left;
                const sectionY = sectionRect.top;
                
                let shouldContinue = false;
                
                arrows.forEach(arrow => {
                    let targetAngle;
                    let targetOpacity;
                    let targetScale = 1;
                    
                    if (animationMode === 'mouse') {
                        const deltaX = lastMouseX - (sectionX + arrow.centerX);
                        const deltaY = lastMouseY - (sectionY + arrow.centerY);
                        targetAngle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;
                        
                        const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                        const maxDistance = 400;
                        const minOpacity = 0.1;
                        const maxOpacity = 0.6;
                        
                        let baseOpacity = maxOpacity - (distance / maxDistance) * (maxOpacity - minOpacity);
                        baseOpacity = Math.max(minOpacity, Math.min(maxOpacity, baseOpacity));
                        
                        targetOpacity = isHoveringQuote ? baseOpacity * 0 : baseOpacity;
                        
                        arrow.currentAngle = smoothAngleTransition(arrow.currentAngle, targetAngle, 10);
                        
                        if (Math.abs(arrow.currentAngle - targetAngle) > 3) {
                            shouldContinue = true;
                        }
                        
                    } else {
                        targetAngle = 0;
                        targetOpacity = isHoveringQuote ? 0.05 : 0.2;
                        arrow.currentAngle = smoothAngleTransition(arrow.currentAngle, targetAngle, 8);
                    }
                    
                    arrow.style.transform = `rotate(${arrow.currentAngle}deg) scale(${targetScale})`;
                    arrow.style.opacity = targetOpacity.toString();
                });
                
                if (shouldContinue || animationMode === 'mouse' || isHoveringQuote) {
                    animationId = requestAnimationFrame(animate);
                } else {
                    isAnimating = false;
                    animationId = null;
                }
            }
            
            animate();
        }
        
        // è¨­ç½®å‹•ç•«æ¨¡å¼
        function setAnimationMode(mode) {
            if (animationMode !== mode) {
                animationMode = mode;
                
                if (!isAnimating) {
                    startAnimation();
                }
            }
        }
        
        // é¼ æ¨™ç§»å‹•è™•ç†
        let lastMouseUpdateTime = 0;
        function updateArrows(mouseX, mouseY) {
            const now = Date.now();
            if (now - lastMouseUpdateTime < 16) return;
            lastMouseUpdateTime = now;
            
            if (Math.abs(mouseX - lastMouseX) < 5 && Math.abs(mouseY - lastMouseY) < 5) return;
            
            lastMouseX = mouseX;
            lastMouseY = mouseY;
            setAnimationMode('mouse');
        }
        
        // æ–‡å­—hoverè™•ç†
        function handleQuoteHover() {
            if (!isAnimating) {
                startAnimation();
            }
        }
        
        // é¼ æ¨™é›¢é–‹æ™‚é‡ç½®ç®­é ­
        function handleMouseLeave() {
            setAnimationMode('idle');
        }
        
        // åˆå§‹åŒ–
        setTimeout(createArrows, 100);
        
        // äº‹ä»¶ç›£è½å™¨
        finalQuote.addEventListener('mouseenter', function() {
            isHoveringQuote = true;
            handleQuoteHover();
        });
        
        finalQuote.addEventListener('mouseleave', function() {
            isHoveringQuote = false;
            handleQuoteHover();
        });
        
        function handleMouseMove(event) {
            updateArrows(event.clientX, event.clientY);
        }
        
        arrowSection.addEventListener('mousemove', handleMouseMove);
        arrowSection.addEventListener('mouseleave', handleMouseLeave);
        
        window.addEventListener('resize', function() {
            setTimeout(createArrows, 100);
        });
    });
</script>

<script>
// æ‰“å­—æ©Ÿæ•ˆæœ - å…§è¯ç‰ˆæœ¬
document.addEventListener('DOMContentLoaded', function() {
        const finalQuoteElement = document.querySelector('.final-quote');
        
        if (!finalQuoteElement) return;
        
        const originalTexts = Array.from(finalQuoteElement.querySelectorAll('p')).map(p => (p.textContent || '').trim());
        
        finalQuoteElement.querySelectorAll('p').forEach(p => p.textContent = '');
        
        const glitchChars = 'morphusai';
        
        let isAnimating = false;
        let hasTriggered = false;
        
        function getRandomChar() {
            return glitchChars[Math.floor(Math.random() * glitchChars.length)];
        }
        
        async function typewriterEffect(element, targetText, delay = 50) {
            return new Promise((resolve) => {
                let currentIndex = 0;
                const totalLength = targetText.length;
                
                element.textContent = '';
                
                const typeInterval = setInterval(() => {
                    if (currentIndex >= totalLength) {
                        clearInterval(typeInterval);
                        element.textContent = targetText;
                        resolve(true);
                        return;
                    }
                    
                    let displayText = '';
                    
                    for (let i = 0; i < currentIndex; i++) {
                        displayText += targetText[i];
                    }
                    
                    if (currentIndex < totalLength) {
                        if (Math.random() > 0.3) {
                            displayText += targetText[currentIndex];
                        } else {
                            displayText += getRandomChar();
                        }
                    }
                    
                    element.textContent = displayText;
                    currentIndex++;
                }, delay);
            });
        }
        
        async function triggerGlitchTypewriter() {
            if (isAnimating || hasTriggered) return;
            if (!finalQuoteElement) return;
            
            isAnimating = true;
            hasTriggered = true;
            
            const paragraphs = finalQuoteElement.querySelectorAll('p');
            
            for (let i = 0; i < paragraphs.length; i++) {
                const paragraph = paragraphs[i];
                const targetText = originalTexts[i];
                
                if (!targetText) continue;
                
                const speed = i === 0 ? 60 : 50;
                
                await typewriterEffect(paragraph, targetText, speed);
                
                if (i < paragraphs.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 300));
                }
            }
            
            isAnimating = false;
        }
        
        const observerOptions = {
            threshold: 0.3,
            rootMargin: '0px 0px -100px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !hasTriggered) {
                    setTimeout(() => {
                        triggerGlitchTypewriter();
                    }, 100);
                }
            });
        }, observerOptions);
        
        observer.observe(finalQuoteElement);
        
        if (window.location.hash === '#debug') {
            window.triggerGlitchEffect = () => {
                hasTriggered = false;
                isAnimating = false;
                triggerGlitchTypewriter();
            };
            console.log('ğŸ› èª¿è©¦æ¨¡å¼ï¼šä½¿ç”¨ triggerGlitchEffect() æ‰‹å‹•è§¸ç™¼æ•ˆæœ');
        }
    });
</script>